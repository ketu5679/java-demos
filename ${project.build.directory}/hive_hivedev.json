{"serviceName":"hivedev","serviceId":2,"policyVersion":126,"policyUpdateTime":"20210105-18:41:39.000-+0800","policies":[{"service":"hivedev","name":"default_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["tmp"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true},{"type":"update","isAllowed":true},{"type":"create","isAllowed":true},{"type":"drop","isAllowed":true},{"type":"alter","isAllowed":true},{"type":"index","isAllowed":true},{"type":"lock","isAllowed":true},{"type":"all","isAllowed":true},{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"repladmin","isAllowed":true},{"type":"serviceadmin","isAllowed":true},{"type":"tempudfadmin","isAllowed":true},{"type":"refresh","isAllowed":true}],"users":[],"groups":["default","public"],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":["tmp"],"zoneName":"","isDenyAllElse":false,"id":27,"guid":"9fab63f1-2c01-4514-980c-7af34c8918e7","isEnabled":true,"version":4},{"service":"hivedev","name":"information_schema","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["information_schema"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true}],"users":[],"groups":["public"],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":["information_schema"],"zoneName":"","isDenyAllElse":false,"id":28,"guid":"50d28246-3064-49d0-9313-6be94186bec5","isEnabled":true,"version":5},{"service":"hivedev","name":"10000278_dm_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["dm"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["zzz_t1","m1"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true}],"users":["10000278"],"groups":[],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":["10000278","dm"],"zoneName":"","isDenyAllElse":false,"id":30,"guid":"05e4dfa8-f448-4d7e-b898-47c5d039f432","isEnabled":true,"version":9},{"service":"hivedev","name":"admin_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true},{"type":"update","isAllowed":true},{"type":"create","isAllowed":true},{"type":"drop","isAllowed":true},{"type":"alter","isAllowed":true},{"type":"index","isAllowed":true},{"type":"lock","isAllowed":true},{"type":"all","isAllowed":true},{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"repladmin","isAllowed":true},{"type":"serviceadmin","isAllowed":true},{"type":"tempudfadmin","isAllowed":true},{"type":"refresh","isAllowed":true}],"users":["10006596"],"groups":[],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":33,"guid":"82421338-910e-43fe-9240-27b69f88b385","isEnabled":true,"version":1},{"service":"hivedev","name":"10014783_dm_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["dm"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["zzz_t3","10014783","zzz_t1","zzz_t2"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true}],"users":["10014783"],"groups":[],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":51,"guid":"06951604-e020-4aa5-b08f-58c0da8e0acd","isEnabled":true,"version":6},{"service":"hivedev","name":"finance_fi_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["fi"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"all","isAllowed":true},{"type":"drop","isAllowed":true},{"type":"serviceadmin","isAllowed":true},{"type":"select","isAllowed":true},{"type":"read","isAllowed":true},{"type":"update","isAllowed":true},{"type":"create","isAllowed":true},{"type":"index","isAllowed":true},{"type":"lock","isAllowed":true},{"type":"refresh","isAllowed":true},{"type":"repladmin","isAllowed":true},{"type":"write","isAllowed":true},{"type":"alter","isAllowed":true}],"users":["10000278","10013840","10013849"],"groups":["finance"],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":55,"guid":"97d8cc2b-acda-47ca-80a3-4263725d1e0a","isEnabled":true,"version":1},{"service":"hivedev","name":"ai_rs_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["rs"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"all","isAllowed":true},{"type":"drop","isAllowed":true},{"type":"serviceadmin","isAllowed":true},{"type":"select","isAllowed":true},{"type":"read","isAllowed":true},{"type":"update","isAllowed":true},{"type":"create","isAllowed":true},{"type":"index","isAllowed":true},{"type":"lock","isAllowed":true},{"type":"refresh","isAllowed":true},{"type":"repladmin","isAllowed":true},{"type":"write","isAllowed":true},{"type":"alter","isAllowed":true}],"users":["10007575","10007974","10009366","10009378","10015451","10015547","10000090","10009707","10006273","10006720","10007989","10008655","10010906","10010920","10015155","10015313","10007950","10009872","10009990","10013459","10015029","10016032","10014974","10015419","10015535","10015687","8888888888","999999999","7777777777"],"groups":["ai"],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":56,"guid":"1a331a51-0984-4615-b683-496b6bda6bc7","isEnabled":true,"version":3},{"service":"hivedev","name":"10014783_rs_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["rs"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["10014783","rs1","rs1_cate"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true}],"users":["10014783"],"groups":[],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":57,"guid":"713c9ec3-4ff5-40ee-9f81-285c7e65e5a8","isEnabled":true,"version":2},{"service":"hivedev","name":"10000279_dm_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["dm"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["zzz_t1","m1","10000279"],"isExcludes":false,"isRecursive":false}},"policyItems":[],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":58,"guid":"6b5b1363-b917-48c9-af0c-8d8dc395b3cb","isEnabled":true,"version":2},{"service":"hivedev","name":"10000114_dm_policy","policyType":0,"policyPriority":0,"description":"","isAuditEnabled":true,"resources":{"database":{"values":["dm"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["10000114","dm_test_d","fff","dm_xx_d"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"select","isAllowed":true}],"users":["10000114"],"groups":[],"roles":[],"conditions":[],"delegateAdmin":false}],"denyPolicyItems":[],"allowExceptions":[],"denyExceptions":[],"dataMaskPolicyItems":[],"rowFilterPolicyItems":[],"serviceType":"hive","options":{},"validitySchedules":[],"policyLabels":[],"zoneName":"","isDenyAllElse":false,"id":59,"guid":"fb675c15-011f-4830-9dc9-6bb4d25bb812","isEnabled":true,"version":5}],"serviceDef":{"name":"hive","implClass":"org.apache.ranger.services.hive.RangerServiceHive","label":"Hive Server2","description":"Hive Server2","options":{"enableDenyAndExceptionsInPolicies":"true"},"configs":[{"itemId":1,"name":"username","type":"string","mandatory":true,"validationRegEx":"","validationMessage":"","uiHint":"","label":"Username"},{"itemId":2,"name":"password","type":"password","mandatory":true,"validationRegEx":"","validationMessage":"","uiHint":"","label":"Password"},{"itemId":3,"name":"jdbc.driverClassName","type":"string","mandatory":true,"defaultValue":"org.apache.hive.jdbc.HiveDriver","validationRegEx":"","validationMessage":"","uiHint":""},{"itemId":4,"name":"jdbc.url","type":"string","mandatory":true,"defaultValue":"","validationRegEx":"","validationMessage":"","uiHint":"{\"TextFieldWithIcon\":true, \"info\": \"1.For Remote Mode, eg.\u003cbr\u003ejdbc:hive2://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;\u003cbr\u003e2.For Embedded Mode (no host or port), eg.\u003cbr\u003ejdbc:hive2:///;initFile\u003d\u0026lt;file\u0026gt;\u003cbr\u003e3.For HTTP Mode, eg.\u003cbr\u003ejdbc:hive2://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/;\u003cbr\u003etransportMode\u003dhttp;httpPath\u003d\u0026lt;httpPath\u0026gt;\u003cbr\u003e4.For SSL Mode, eg.\u003cbr\u003ejdbc:hive2://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/;ssl\u003dtrue;\u003cbr\u003esslTrustStore\u003dtStore;trustStorePassword\u003dpw\u003cbr\u003e5.For ZooKeeper Mode, eg.\u003cbr\u003ejdbc:hive2://\u0026lt;host\u0026gt;/;serviceDiscoveryMode\u003d\u003cbr\u003ezooKeeper;zooKeeperNamespace\u003dhiveserver2\u003cbr\u003e6.For Kerberos Mode, eg.\u003cbr\u003ejdbc:hive2://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/;\u003cbr\u003eprincipal\u003dhive/domain@EXAMPLE.COM\u003cbr\u003e\"}"},{"itemId":5,"name":"commonNameForCertificate","type":"string","mandatory":false,"validationRegEx":"","validationMessage":"","uiHint":"","label":"Common Name for Certificate"}],"resources":[{"itemId":1,"name":"database","type":"string","level":10,"mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Hive Database","description":"Hive Database","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":5,"name":"url","type":"string","level":10,"mandatory":true,"lookupSupported":false,"recursiveSupported":true,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerURLResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"URL","description":"URL","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":6,"name":"hiveservice","type":"string","level":10,"mandatory":true,"lookupSupported":false,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Hive Service","description":"Hive Service","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":7,"name":"global","type":"string","level":10,"mandatory":false,"lookupSupported":false,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Global","description":"Global","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":2,"name":"table","type":"string","level":20,"parent":"database","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Hive Table","description":"Hive Table","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":3,"name":"udf","type":"string","level":20,"parent":"database","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Hive UDF","description":"Hive UDF","accessTypeRestrictions":[],"isValidLeaf":true},{"itemId":4,"name":"column","type":"string","level":30,"parent":"table","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"","label":"Hive Column","description":"Hive Column","accessTypeRestrictions":[],"isValidLeaf":true}],"accessTypes":[{"itemId":1,"name":"select","label":"select","impliedGrants":[]},{"itemId":2,"name":"update","label":"update","impliedGrants":[]},{"itemId":3,"name":"create","label":"Create","impliedGrants":[]},{"itemId":4,"name":"drop","label":"Drop","impliedGrants":[]},{"itemId":5,"name":"alter","label":"Alter","impliedGrants":[]},{"itemId":6,"name":"index","label":"Index","impliedGrants":[]},{"itemId":7,"name":"lock","label":"Lock","impliedGrants":[]},{"itemId":8,"name":"all","label":"All","impliedGrants":["select","update","create","drop","alter","index","lock","read","write","repladmin","serviceadmin","refresh"]},{"itemId":9,"name":"read","label":"Read","impliedGrants":[]},{"itemId":10,"name":"write","label":"Write","impliedGrants":[]},{"itemId":11,"name":"repladmin","label":"ReplAdmin","impliedGrants":[]},{"itemId":12,"name":"serviceadmin","label":"Service Admin","impliedGrants":[]},{"itemId":13,"name":"tempudfadmin","label":"Temporary UDF Admin","impliedGrants":[]},{"itemId":14,"name":"refresh","label":"Refresh","impliedGrants":[]}],"policyConditions":[],"contextEnrichers":[],"enums":[],"dataMaskDef":{"maskTypes":[{"itemId":1,"name":"MASK","label":"Redact","description":"Replace lowercase with \u0027x\u0027, uppercase with \u0027X\u0027, digits with \u00270\u0027","transformer":"mask({col})","dataMaskOptions":{}},{"itemId":2,"name":"MASK_SHOW_LAST_4","label":"Partial mask: show last 4","description":"Show last 4 characters; replace rest with \u0027x\u0027","transformer":"mask_show_last_n({col}, 4, \u0027x\u0027, \u0027x\u0027, \u0027x\u0027, -1, \u00271\u0027)","dataMaskOptions":{}},{"itemId":3,"name":"MASK_SHOW_FIRST_4","label":"Partial mask: show first 4","description":"Show first 4 characters; replace rest with \u0027x\u0027","transformer":"mask_show_first_n({col}, 4, \u0027x\u0027, \u0027x\u0027, \u0027x\u0027, -1, \u00271\u0027)","dataMaskOptions":{}},{"itemId":4,"name":"MASK_HASH","label":"Hash","description":"Hash the value","transformer":"mask_hash({col})","dataMaskOptions":{}},{"itemId":5,"name":"MASK_NULL","label":"Nullify","description":"Replace with NULL","dataMaskOptions":{}},{"itemId":6,"name":"MASK_NONE","label":"Unmasked (retain original value)","description":"No masking","dataMaskOptions":{}},{"itemId":12,"name":"MASK_DATE_SHOW_YEAR","label":"Date: show only year","description":"Date: show only year","transformer":"mask({col}, \u0027x\u0027, \u0027x\u0027, \u0027x\u0027, -1, \u00271\u0027, 1, 0, -1)","dataMaskOptions":{}},{"itemId":13,"name":"CUSTOM","label":"Custom","description":"Custom","dataMaskOptions":{}}],"accessTypes":[{"itemId":1,"name":"select","label":"select","impliedGrants":[]}],"resources":[{"itemId":1,"name":"database","type":"string","level":10,"mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"{ \"singleValue\":true }","label":"Hive Database","description":"Hive Database","accessTypeRestrictions":[],"isValidLeaf":false},{"itemId":2,"name":"table","type":"string","level":20,"parent":"database","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"{ \"singleValue\":true }","label":"Hive Table","description":"Hive Table","accessTypeRestrictions":[],"isValidLeaf":false},{"itemId":4,"name":"column","type":"string","level":30,"parent":"table","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"{ \"singleValue\":true }","label":"Hive Column","description":"Hive Column","accessTypeRestrictions":[],"isValidLeaf":true}]},"rowFilterDef":{"accessTypes":[{"itemId":1,"name":"select","label":"select","impliedGrants":[]}],"resources":[{"itemId":1,"name":"database","type":"string","level":10,"mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"{ \"singleValue\":true }","label":"Hive Database","description":"Hive Database","accessTypeRestrictions":[],"isValidLeaf":false},{"itemId":2,"name":"table","type":"string","level":20,"parent":"database","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"true"},"validationRegEx":"","validationMessage":"","uiHint":"{ \"singleValue\":true }","label":"Hive Table","description":"Hive Table","accessTypeRestrictions":[],"isValidLeaf":true}]},"id":3,"guid":"3e1afb5a-184a-4e82-9d9c-87a5cacc243c","isEnabled":true,"createTime":"20201111-15:51:33.000-+0800","updateTime":"20201111-15:51:33.000-+0800","version":1},"auditMode":"audit-default"}